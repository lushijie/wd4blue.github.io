<script>
	//获取yilia theme 的配置信息
	var yiliaConfig = {
		fancybox: <%=theme.fancybox%>,
		mathjax: <%=theme.mathjax%>,
		animate: <%=theme.animate%>,
		isHome: <%=is_home()%>,
		isPost: <%=is_post()%>,
		isArchive: <%=is_archive()%>,
		isTag: <%=is_tag()%>,
		isCategory: <%=is_category()%>,
		open_in_new: <%=theme.open_in_new%>
	}
</script>

<!-- 引入js -->
<script type="text/javascript" src="http://cdn.bootcss.com/require.js/2.0.0/require.js"></script>
<script type="text/javascript">
	require.config({
		paths: {
			"jquery": "http://cdn.bootcss.com/jquery/1.11.3/jquery"
		}
	});
	require(['jquery'], function ($){
		console.log("main.js运行开始");
		var isMobileInit = false;
		var loadMobile = function(){
			// require(['/js/mobile.js'], function(mobile){
			// 	mobile.initMobile();
			// 	isMobileInit = true;
			// });
		}
		var isPCInit = false;
		var loadPC = function(){
			require(['/js/pc.js'], function(pc){
				pc.initPC();
				isPCInit = true;
			});
		}

		var browser={
		    versions:function(){
		    var u = window.navigator.userAgent;
		    return {
		        trident: u.indexOf('Trident') > -1, //IE内核
		        presto: u.indexOf('Presto') > -1, //opera内核
		        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
		        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
		        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
		        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
		        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
		        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
		        iPad: u.indexOf('iPad') > -1, //是否为iPad
		        webApp: u.indexOf('Safari') == -1 ,//是否为web应用程序，没有头部与底部
		        weixin: u.indexOf('MicroMessenger') == -1 //是否为微信浏览器
		        };
		    }()
		}

		// $(window).bind("resize", function(){
		// 	if(isMobileInit && isPCInit){
		// 		$(window).unbind("resize");
		// 		return;
		// 	}
		// 	var w = $(window).width();
		// 	if(w >= 700){
		// 		loadPC();
		// 	}else{
		// 		loadMobile();
		// 	}
		// });

		if(browser.versions.mobile === true || $(window).width() < 700){
			loadMobile();
		}else{
			loadPC();
		}

		// //是否使用fancybox
		// if(yiliaConfig.fancybox === true){
		// 	require(['/fancybox/jquery.fancybox.js'], function(pc){
		// 		var isFancy = $(".isFancy");
		// 		if(isFancy.length != 0){
		// 			var imgArr = $(".article-inner img");
		// 			for(var i=0,len=imgArr.length;i<len;i++){
		// 				var src = imgArr.eq(i).attr("src");
		// 				var title = imgArr.eq(i).attr("alt");
		// 				imgArr.eq(i).replaceWith("<a href='"+src+"' title='"+title+"' rel='fancy-group' class='fancy-ctn fancybox'><img src='"+src+"' title='"+title+"'></a>");
		// 			}
		// 			$(".article-inner .fancy-ctn").fancybox();
		// 		}
		// 	});
		// }
		// //是否开启动画
		// if(yiliaConfig.animate === true){

		// 	require(['/js/jquery.lazyload.js'], function(){
		// 		//avatar
		// 		$(".js-avatar").attr("src", $(".js-avatar").attr("lazy-src"));
		// 		$(".js-avatar")[0].onload = function(){
		// 			$(".js-avatar").addClass("show");
		// 		}
		// 	});
			
		// 	if(yiliaConfig.isHome === true){
		// 		//content
		// 		function showArticle(){
		// 			$(".article").each(function(){
		// 				if( $(this).offset().top <= $(window).scrollTop()+$(window).height() && !($(this).hasClass('show')) ) {
		// 					$(this).removeClass("hidden").addClass("show");
		// 					$(this).addClass("is-hiddened");
		// 				}else{
		// 					if(!$(this).hasClass("is-hiddened")){
		// 						$(this).addClass("hidden");
		// 					}
		// 				}
		// 			});
		// 		}
		// 		$(window).on('scroll', function(){
		// 			showArticle();
		// 		});
		// 		showArticle();
		// 	}
		// }
		// //是否新窗口打开链接
		// if(yiliaConfig.open_in_new == true){
		// 	$(".article a[href]").attr("target", "_blank")
		// }
	});
</script>
<!-- <script type="text/javascript" src="js/jquery.js"></script> -->
<!--<%- js('js/main') %>-->

<!-- 弹出展示效果 -->
<% if (theme.fancybox){ %>
  <%- css('fancybox/jquery.fancybox') %>
<% } %>

<!-- swiftype组件 -->
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','s9hJzvXizJRGVfLFxGqy','2.0.0');
</script>

<!-- 引入谷歌分析 -->
<%- partial('google-analytics') %>

<!--  数学公式显示 -->
<% if (theme.mathjax){ %>
<%- partial('mathjax') %>
<% } %>